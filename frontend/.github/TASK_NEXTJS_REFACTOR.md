# T√ÇCHE CODEX ‚Äì REFACTORISATION NEXT.JS

## CONTEXTE
CETTE T√ÇCHE S‚ÄôAPPLIQUE √Ä UN PROJET **NEXT.JS 16.X** UTILISANT :
- APP ROUTER (PRIORITAIRE)
- REACT SERVER COMPONENTS
- SERVER ACTIONS
- TYPESCRIPT STRICT

LE CONTEXTE PROJET FOURNI (ARCHITECTURE, CONVENTIONS, CACHE) EST **AUTORITAIRE**.

---

## OBJECTIF
AM√âLIORER LA **LISIBILIT√â**, LA **MAINTENABILIT√â** ET LA **COH√âRENCE** DU CODE EXISTANT **SANS MODIFIER LE COMPORTEMENT FONCTIONNEL**.

---

## R√àGLE CARDINALE
üö® **AUCUN CHANGEMENT FONCTIONNEL**  
LE RENDU, LES ROUTES, LES DONN√âES ET LES EFFETS OBSERVABLES DOIVENT RESTER STRICTEMENT IDENTIQUES.

---

## P√âRIM√àTRE DE REFACTORISATION AUTORIS√â

### ARCHITECTURE
- CLARIFIER LA S√âPARATION :
  - SERVER COMPONENTS / CLIENT COMPONENTS
  - UI / LOGIQUE M√âTIER
- SIMPLIFIER L‚ÄôARBORESCENCE SI REDONDANTE
- RENOMMER FICHIERS OU FONCTIONS SI CELA AM√âLIORE LA COMPR√âHENSION

### COMPOSANTS
- SUPPRIMER LES `"USE CLIENT"` INUTILES
- EXTRAIRE LES COMPOSANTS TROP LONGS
- R√âDUIRE LA PROFONDEUR D‚ÄôIMBRICATION JSX

### DONN√âES & CACHE
- UNIFORMISER L‚ÄôUSAGE DU CACHE (`CACHELIFE`, `CACHETAG`)
- CENTRALISER LA LOGIQUE DE FETCH SI DUPLIQU√âE
- V√âRIFIER LA COH√âRENCE DES TAGS DE REVALIDATION

### SERVER ACTIONS
- ISOLER VALIDATION / MUTATION
- NETTOYER LES SIGNATURES
- HARMONISER LA GESTION DES ERREURS

### TYPESCRIPT
- SUPPRIMER LES `ANY`
- RENDRE LES TYPES EXPLICITES
- EXTRAIRE LES TYPES R√âUTILISABLES

---

## INTERDICTIONS STRICTES

- ‚ùå CHANGER LA LOGIQUE M√âTIER
- ‚ùå AJOUTER UNE D√âPENDANCE
- ‚ùå MODIFIER UNE API PUBLIQUE
- ‚ùå INTRODUIRE UNE NOUVELLE FEATURE
- ‚ùå ‚ÄúOPTIMISER‚Äù SANS JUSTIFICATION CLAIRE

---

## √âTAPES ATTENDUES

1. **ANALYSE**
   - IDENTIFIER LES PROBL√àMES DE LISIBILIT√â
   - LISTER LES DUPLICATIONS
   - REP√âRER LES INCOH√âRENCES ARCHITECTURALES

2. **PLAN DE REFACTOR**
   - D√âCRIRE BRI√àVEMENT CE QUI SERA MODIFI√â
   - JUSTIFIER CHAQUE CHANGEMENT

3. **REFACTOR**
   - APPLIQUER LES CHANGEMENTS UN PAR UN
   - CONSERVER LES SIGNATURES PUBLIQUES
   - GARDER LES COMPORTEMENTS INCHANG√âS

4. **V√âRIFICATION**
   - CONFIRMER QU‚ÄôAUCUNE FONCTIONNALIT√â N‚ÄôEST ALT√âR√âE
   - V√âRIFIER COH√âRENCE APP ROUTER / SERVER COMPONENTS

---

## SORTIE ATTENDUE

### CODE
- FOURNIR LES FICHIERS **COMPLETS** SI CR√â√âS
- MONTRER UNIQUEMENT LES **DIFFS PERTINENTS** SI MODIFI√âS
- INDIQUER CLAIREMENT LES CHEMINS (`APP/...`, `LIB/...`)

### TEXTE
- LISTE CONCISE DES AM√âLIORATIONS
- PAS DE JUSTIFICATION √âVIDENTE
- PAS DE REFORMULATION DE LA CONSIGNE

---

## CRIT√àRES DE R√âUSSITE

- CODE PLUS LISIBLE QU‚ÄôAVANT
- ARCHITECTURE PLUS CLAIRE
- AUCUN CHANGEMENT FONCTIONNEL
- CONFORME AUX CONVENTIONS NEXT.JS 16.X
- REFACTOR FACILEMENT R√âVERSIBLE SI N√âCESSAIRE

---

## EN CAS DE DOUTE
**STOP.**  
DEMANDER UNE CLARIFICATION AVANT TOUTE MODIFICATION.
