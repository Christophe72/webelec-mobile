# T√ÇCHE CODEX ‚Äì AUDIT CACHE & PERFORMANCE NEXT.JS

## CONTEXTE
PROJET BAS√â SUR **NEXT.JS 16.X** AVEC :
- APP ROUTER
- REACT SERVER COMPONENTS
- SERVER ACTIONS
- FETCH AVEC CACHE INT√âGR√â
- D√âPLOIEMENT TYPE VERCEL OU √âQUIVALENT

LE CONTEXTE NEXT.JS ET LES CONVENTIONS PROJET SONT **PRIORITAIRES**.

---

## OBJECTIF
IDENTIFIER ET DOCUMENTER LES **PROBL√àMES DE PERFORMANCE**, DE **CACHE MAL MA√éTRIS√â** ET DE **RENDU INUTILE**, PUIS PROPOSER DES **CORRECTIFS PR√âCIS** SANS MODIFIER LE COMPORTEMENT FONCTIONNEL.

---

## P√âRIM√àTRE DE L‚ÄôAUDIT

### 1. RENDU & COMPOSANTS
- D√âTECTER LES CLIENT COMPONENTS INUTILES
- IDENTIFIER LES RERENDERS √âVITABLES
- V√âRIFIER L‚ÄôUSAGE CORRECT DES SERVER COMPONENTS
- REP√âRER LES COMPOSANTS TROP LOURDS OU TROP PROFONDS

### 2. DATA FETCHING
- V√âRIFIER CHAQUE `FETCH`
- IDENTIFIER :
  - `NO-STORE` ABUSIFS
  - `FORCE-CACHE` MAL UTILIS√âS
  - `REVALIDATE` INCOH√âRENTS
- D√âTECTER LES FETCH DUPLIQU√âS

### 3. CACHE AVANC√â
- USAGE DE :
  - CACHELIFE()
  - CACHETAG()
  - UNSTABLE_CACHE()
- COH√âRENCE DES TAGS
- GRANULARIT√â DE LA REVALIDATION
- SUR-REVALIDATION INUTILE

### 4. SERVER ACTIONS
- MUTATIONS D√âCLENCHANT TROP DE REVALIDATION
- `REFRESH()` UTILIS√â SANS N√âCESSIT√â
- REVALIDATEPATH GLOBAL AU LIEU DE CIBL√â

### 5. ROUTING & NAVIGATION
- PAGES DYNAMIQUES RENDUES INUTILEMENT C√îT√â CLIENT
- MAUVAIS USAGE DE `USEROUTER`, `USESEARCHPARAMS`
- PR√âFETCH EXCESSIF OU ABSENT

### 6. ASSETS & FRONTEND
- IMAGES NON OPTIMIS√âES
- NEXT/IMAGE MAL CONFIGUR√â
- DYNAMIC IMPORTS ABSENTS L√Ä O√ô UTILES

---

## CE QUE CODEX DOIT PRODUIRE

### DIAGNOSTIC
- LISTE CLAIRE DES PROBL√àMES D√âTECT√âS
- LOCALISATION PR√âCISE (FICHIER + LIGNE APPROXIMATIVE)
- GRAVIT√â :
  - ‚ö†Ô∏è MINEUR
  - ‚ùó IMPORTANT
  - üö® CRITIQUE

### ANALYSE
- CAUSE DU PROBL√àME
- IMPACT :
  - PERFORMANCE
  - CACHE
  - UX
  - CO√õT SERVEUR

### RECOMMANDATIONS
- CORRECTIFS PR√âCIS
- LIMIT√âS AU STRICT N√âCESSAIRE
- SANS AJOUT DE D√âPENDANCE
- SANS CHANGEMENT FONCTIONNEL

---

## INTERDICTIONS

- ‚ùå MODIFIER LE CODE SANS DEMANDE EXPLICITE
- ‚ùå AJOUTER UNE FEATURE
- ‚ùå REFACTOR MASSIF NON CIBL√â
- ‚ùå ‚ÄúOPTIMISATION TH√âORIQUE‚Äù SANS IMPACT R√âEL

---

## √âTAPES ATTENDUES

1. **SCAN**
   - PARCOURIR ROUTES, COMPOSANTS ET DATA LAYER
   - IDENTIFIER LES POINTS CHAUDS

2. **CARTOGRAPHIE**
   - FLUX DE DONN√âES
   - ZONES RECALCUL√âES INUTILEMENT
   - POINTS DE CACHE FAIBLES

3. **AUDIT**
   - CACHE
   - RENDU
   - NAVIGATION
   - ASSETS

4. **RAPPORT**
   - PROBL√àMES LIST√âS
   - PRIORISATION
   - RECOMMANDATIONS CONCR√àTES

---

## SORTIE ATTENDUE

### TEXTE UNIQUEMENT (PAR D√âFAUT)
- RAPPORT STRUCTUR√â
- SECTIONS CLAIRES
- PAS DE CODE SAUF DEMANDE EXPLICITE

### OPTIONNEL (SI DEMAND√â)
- PATCHES CIBL√âS
- EXTRAITS DE CODE MINIMAUX
- AUCUN CHANGEMENT HORS P√âRIM√àT
